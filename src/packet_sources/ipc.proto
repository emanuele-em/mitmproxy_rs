syntax = "proto3";

package mitmproxy.ipc;

message FromRedirector {
  oneof message {
    PacketWithMeta packet = 1;
    SignalWithMessage signal = 2;
  }
}
message PacketWithMeta {
  bytes data = 1;
  uint32 pid = 2;
  optional string process_name = 3;
}
message SignalWithMessage {
  Sig code = 1;
  optional string message = 2;
}

message FromProxy {
  oneof message {
    Packet packet = 1;
    InterceptSpec intercept_spec = 2;
  }
}
message Packet {
  bytes data = 1;
}
message InterceptSpec {
  string spec = 1;
}
enum Sig {
    ExitSuccess = 0;
    ExitFailure = 1;
}
